#****************************************************************************#
#* DIET dmat_manips example: Makefile                                       *#
#*                                                                          *#
#*  Author(s):                                                              *#
#*    - Philippe COMBES (Philippe.Combes@ens-lyon.fr)                       *#
#*                                                                          *#
#* $LICENSE$                                                                *#
#****************************************************************************#
#* $Id$
#* $Log$
#* Revision 1.23  2006/01/13 10:41:53  mjan
#* Updating DIET for next JuxMem (0.2)
#*
#* Revision 1.22  2005/05/27 08:18:17  mjan
#* Moving JuxMem in a more appropriate place (src/utils)
#* Added log messages for VizDIET
#* Added use of JuxMem in the client side
#*
#* Revision 1.21  2005/05/18 14:18:10  mjan
#* Initial adding of JuxMem support inside DIET. dmat_manips examples tested without JuxMem and with JuxMem
#*
#* Revision 1.20  2004/02/27 10:44:04  bdelfabr
#* clientWithID example added
#*
#* Revision 1.19  2004/01/07 23:07:12  cpera
#* Add new asynchronous example "parallelclient4.cc" about diet_wait_or function.
#*
#* Revision 1.18  2003/10/21 13:32:28  bdelfabr
#* removing clientWithID and clientWithoutID examples
#*
#* Revision 1.17  2003/10/14 20:25:06  bdelfabr
#* update Makefile - adding clientWithoutID
#*
#* Revision 1.16  2003/10/10 15:27:32  bdelfabr
#* adding clientWithID example for Persistance -to be completed
#*
#* Revision 1.15  2003/09/26 14:07:01  pcombes
#* Get the examples out of the automake chain, to make Makefiles more readable.
#* The generated before.mk includes the right Makefile.inc.
#*
#****************************************************************************#

##
# The following lines are necessary to include this example in the
# configuration chain of DIET.
#
srcdir = @srcdir@
subdir = src/examples/dmat_manips
SOURCES = client.c server.c serialClient.cc clientWithID.c clientJuxMem.c \
	  parallelClient.cc parallelClient2.cc parallelClient3.cc parallelClient4.cc
HEADERS = progs.h Global_macros.hh
#
# before.mk includes the right Makefile.inc. Indeed, the user might wish to
# compile this example without installing actually DIET ; thus we cannot assume
# that the Makefile.inc is really in $(prefix): if it is not installed, then we
# will look for it in the build directory.
# If we could be sure that Makefile.inc is installed before compiling this
# example, we would simply add the following line, which is what the user should
# do for his own examples: include $(prefix)/include/Makefile.inc
#
include ../before.mk
#
##

CC_PROGRAMS = client server clientWithID clientJuxMem
CXX_PROGRAMS = serialClient parallelClient parallelClient2 parallelClient3 parallelClient3 parallelClient4
PROGRAMS = $(CC_PROGRAMS) $(CXX_PROGRAMS)

all:	$(PROGRAMS)

client: client.c $(DIET_CLIENT_PREREQ)
	$(CC) $(CCFLAGS_DIET) $< $(DIET_CLIENT_LIBS) -o $@

clientWithID: clientWithID.c $(DIET_CLIENT_PREREQ)
	$(CC) $(CCFLAGS_DIET) $< $(DIET_CLIENT_LIBS) -o $@

clientJuxMem: clientJuxMem.c $(DIET_CLIENT_PREREQ)
	$(CC) $(CCFLAGS_DIET) -g $< $(DIET_CLIENT_LIBS) -o $@

# As the server uses the __FAST_*__ macros, we must exceptionnally add
# the flag -I ../../../include.
server:	server.c $(DIET_SERVER_PREREQ)
	$(CC) $(CCFLAGS_DIET) -g -I $(top_builddir)/include $<	\
	      $(DIET_SERVER_LIBS)  -o $@

# Implicit rule for all CXX clients
%:	%.cc Global_macros.hh $(DIET_CLIENT_PREREQ)
	$(CXX) $(CXXFLAGS_DIET) @CXXFLAG_NO_CTOR_DTOR_PRIVACY@ $< $(DIET_CLIENT_LIBS) -o $@

