/****************************************************************************/
/* DIET agent IDL description                                               */
/*                                                                          */
/*  Author(s):                                                              */
/*    - Philippe COMBES (Philippe.Combes@ens-lyon.fr)                       */
/*    - Sylvain DAHAN (Sylvain.Dahan@lifc.univ-fcomte.fr)                   */
/*    - Frederic LOMBARD (Frederic.Lombard@lifc.univ-fcomte.fr)             */
/*                                                                          */
/* $LICENSE$                                                                */
/****************************************************************************/
/* $Id$
 * $Log$
 * Revision 1.12  2010/11/24 15:12:56  bdepardo
 * searchData is now available on all agents. SeDs are now able to retrieve
 * a DAGDA data from an alias specified by a client.
 * Currently a SeD cannot declare an alias.
 *
 * Revision 1.11  2010/07/12 15:54:07  glemahec
 * DIET 2.5 beta 1 - Forwarder IDL files
 *
 * Revision 1.10  2009/10/26 09:06:40  bdepardo
 * Added 1 method to dynamically manage the hierarchy:
 * - long removeElement(in boolean recursive): kills the element, and
 *   recursively its children
 * Added a method for a child to unsubscribe: childUnsubscribe(...).
 * Renamed serverRemoveService(...) to childRemoveService(...)
 *
 * Revision 1.9  2008/11/18 10:12:32  bdepardo
 * - Added the possibility to dynamically create and destroy a service
 *   (even if the SeD is already started). An example is available.
 *   This feature only works with DAGDA.
 * - Added policy commands for CMake 2.6
 * - Added the name of the service in the profile. It was only present in
 *   the profile description, but not in the profile. Currently, the name is
 *   copied in each solve function, but this should certainly be moved
 *   somewhere else.
 *
 * Revision 1.8  2008/04/28 07:08:28  glemahec
 * The DAGDA API.
 *
 * Revision 1.7  2006/05/22 06:32:29  eboix
 *     Reverting to version 1.5 because of compilation error with JXTA mode
 *     on. --- Injay2461
 *
 * Revision 1.6  2006/04/04 10:18:58  lphilipp
 *
 * Ajout d'un README, avec quelques explications
 * MIse a jour des IDL
 * Quelques changements
 *
 * Revision 1.5  2005/05/15 15:34:08  alsu
 * to indicate success/failure, addServices now returns a value
 *
 * Revision 1.4  2004/09/29 13:35:31  sdahan
 * Add the Multi-MAs feature.
 *
 * Revision 1.3  2004/06/11 15:45:39  ctedesch
 * add DIET/JXTA
 *
 * Revision 1.2  2003/09/22 21:21:45  pcombes
 * Set all the modules and their interfaces for data persistency.
 *
 * Revision 1.1  2003/04/10 12:30:49  pcombes
 * Replace agent.idl. Get rid of response definitions and of type decision.
 ****************************************************************************/


#ifndef _AGENT_IDL_
#define _AGENT_IDL_

#include "common_types.idl"
#include "response.idl"

/****************************************************************************/
/* Agent interface                                                          */
/****************************************************************************/

interface Agent {

  /**
   * Invoked by other agents to register as a child of this agent. As it is
   * useless to register without offering services, the last argument is the
   * same as for addServices method. Returns a registration number wich
   * indentifies the child amongst the other children of this agent.
   */
  long agentSubscribe(in string agentName, in string hostname,
			       in SeqCorbaProfileDesc_t services);
  /**
   * Invoked by servers to register as a child of this agent. As it is useless
   * to register without offering services, the last argument is the same as for
   * addServices method. Returns a registration number wich indentifies the
   * child amongst the other children of this agent.
   */
  long serverSubscribe(in string seDName,
                       in string hostname,
                       in SeqCorbaProfileDesc_t services);

  /** Sends a request to the agent to commit suicide.
   * If "recursive" is true, then the agent forwards the request
   * to its children.
   */
  long removeElement(in boolean recursive);

  /**
   * Invoked by servers or LA to unregister as a child from this agent.
   * This also unregister the services offered by the child in the
   * service table of the agent.
   */
  long childUnsubscribe(in unsigned long childID,
			in SeqCorbaProfileDesc_t services);

  /**
   * Invoked by SeDImpl::removeService(...) after removing a service
   * locally on a SeD. Used to inform the rest of the hierarchy that this
   * service is no longer available on this SeD.
   */
  long childRemoveService(in unsigned long childID,
			  in corba_profile_desc_t profile);

  /**
   * Service table update method. Propagate the update of the problem list up
   * the tree when a new child registers. The first parameter is the child's
   * registration number.
   */
  long addServices(in unsigned long myID,
                   in SeqCorbaProfileDesc_t services);


  /**
   * Message posting functions:
   * This call is asynchronous. The response message REQ is kept in an
   * internal list and processed as soon as possible.
   */
  oneway void getResponse(in corba_response_t resp);


  /** Used to test if this agent is alive. */
  long ping();

  /** Used to get the host name of the Agent */
  string getHostname() ;
  string getDataManager();
  SeqString searchData(in string request);
};


#endif // _AGENT_IDL_

