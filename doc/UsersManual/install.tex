%****************************************************************************%
%* DIET User's Manual installing chapter file                               *%
%*                                                                          *%
%*  Author(s):                                                              *%
%*    - Eddy CARON (Eddy.Caron@ens-lyon.fr)                                 *%
%*    - Pushpinder Kaur Chouhan (Pushpinder.Kaur.Chouhan@ens-lyon.fr)       *%
%*    - Philippe COMBES (Philippe.Combes@ens-lyon.fr)                       *%
%*                                                                          *%
%* $LICENSE$                                                                *%
%****************************************************************************%
%* $Id$
%* $Log$
%* Revision 1.27  2006/10/12 09:10:28  eboix
%*   More cmake's docs. --- Injay2461
%*
%*
%* Revision 1.25  2006/05/12 12:12:32  sdahan
%* Add some documentation about multi-MA
%*
%* Bug fix:
%*  - segfault when the neighbours configuration line was empty
%*  - deadlock when a MA create a link on itself
%*
%* Revision 1.24  2006/01/25 16:52:55  pfrauenk
%* CoRI : renaming of the chapter performance prediction with fast
%* 	to performance prediction, add of the CoRI Usersmanual,
%* 	changes in the plugin scheduler
%*
%* Revision 1.23  2005/08/26 08:32:42  rbolze
%* remove --enable-logservice feature.
%*
%* Revision 1.22  2005/07/12 08:54:10  ecaron
%* fix BLAS and ScaLAPACK (no fixme in fact)
%*
%* Revision 1.21  2005/06/27 19:26:52  hdail
%* - Moved introduction to FAST to description section with intro to multi-MA and
%*   gave both chapter references.
%* - Changed version number to 2.0.
%* - Moved info on compiling FAST itself to fast section from install section.
%*   install section still explains how to configure DIET with FAST.
%*
%* Revision 1.20  2005/06/24 15:07:29  hdail
%* Continuing english corrections and updating.
%*
%* Revision 1.19  2005/06/14 08:06:20  ecaron
%* Update ./configure output
%*
%* Revision 1.18  2005/05/29 13:51:22  ycaniou
%* Moved the section concerning FAST from description to a new chapter about FAST
%* and performances prediction.
%* Moved the section about convertors in the FAST chapter.
%* Modified the small introduction in chapter 1.
%* The rest of the changes are purely in the format of .tex files.
%*
%* Revision 1.17  2005/05/20 19:06:01  mjan
%* Short description of how to configure DIET for JuxMem
%*
%* Revision 1.16  2004/10/25 08:59:56  sdahan
%* add the multi-MA documentation
%*
%* Revision 1.15  2004/07/12 08:33:58  rbolze
%* explain how to copy cfgs file in install_dir/etc directory and correct my english
%****************************************************************************%

\chapter{DIET installation}
\label{ch:installing}

%====[ Dependencies ]==========================================================
\section{Dependencies}
\label{sec:dependencies}

\subsection{Platform dependencies}

DIET is fully tested on Linux/i386 and Linux/i686 platforms.
But DIET also supports other architectures (thanks to users reports or
to punctual deployments). In particular DIET is known to be effective
on Linux/Sparc, Linux/i64, Linux/amd64 and Linux/Alpha platforms.
At some point DIET used to be tested on the Solaris/Sparc platform (although
it's been a long time).

If you find a bug in DIET, please don't hesitate to submit a bug report at
\url{http://graal.ens-lyon.fr/bugzilla}. If you have multiple bugs
to report, please make multiple submissions, rather than submitting
multiple bugs in a single report.

As for the supported C++ compilers, DIET undergoes daily regression tests
(see \url{http://graal.ens-lyon.fr/DietDashboard}) with GCC's g++ (ranging
from version 3.2.X to 4.1.x).

\subsection{Software dependencies}
\label{sec:software_dependencies}

As explained in Section~\ref{sec:CORBA}, CORBA is used for all
communications inside the platform. The implementations of CORBA
currently supported in DIET is \textbf{omniORB 4} which depends on
\textbf{Python 2.1} or later, and on \textbf{OpenSSL} if you wish
to secure your DIET platform.~\footnote{If you want to deploy a
secure DIET platform, SSL support is not yet implemented  in DIET, but
an easy way to do so is to deploy DIET on a VPN.}
% \item{soon \textbf{TAO 1.3}} which depends on \textbf{ACE} (but TAO is always
%                           provided with ACE)

In order to deploy CORBA services with omniORB, a configuration file
and a log directory are required: see Section
\ref{sec:CORBA_services} for a complete description of the services.
Their paths can be given to omniORB through environment variables
(\texttt{\$OMNIORB\_CONFIG} and \texttt{\$OMNINAMES\_LOGDIR}), and/or,
for \textbf{omniORB 4} only, at compile time, with the
\texttt{--with-omniORB-config} and \texttt{--with-omniNames-logdir}
options.

\noindent 
\textbf{NB:} We have noticed that some problems occur with
\textbf{Python 2.3}: the C++ code generated could not be compiled. It
has been patched in DIET, but some warnings still appear.  \\

Since omniORB needs thread-safe management of exception handling,
compiling DIET with \verb+gcc+ requires at least \verb+gcc-2.96+.  \\

Some examples provided in the DIET sources depend on the BLAS
and \scalapack\ libraries. However the compilation of those BLAS dependent
examples are optional.


%====[ Compilation ]===========================================================
\section{Compiling the platform}
\label{sec:compil_platform}

DIET compilation process is moving from the traditional \verb+autotools+
way of things to a tool named \verb+cmake+ (mainly to benefit from
\verb+cmake+'s built-in regression tests mechanism).
During a short transitional period both compiling tools will be available. 
Nevertheless, whenever if possible, \verb+cmake+ should be seen as the
privileged (and supported) tool.
The \verb+autotools+ should be definitively deprecated in the next version.
The following of this section explains the usage of both tools.

Before compiling DIET itself, first install the above mentioned
(cf section~\ref{sec:software_dependencies}) dependencies.
Then untar the DIET archive and change current directory to its root directory.

%====[ Compilation with cmake ]================================================
\subsection{Compiling DIET with cmake}

%==================
\subsubsection{Obtaining and installing cmake per se}
DIET requires using \verb+cmake+ at least version \verb+2.4.3+.
For many popular distributions \verb+cmake+ is incorporated by
default or at least \verb+apt-get+ (or whatever your distro package installer
might be) is \verb+cmake+ aware.
Still, in case you need to install an up-to-date version \verb+cmake+'s
official site distributes many binary versions (alas packaged as tarballs)
as made available at 
\url{http://www.cmake.org/HTML/Download.html}.
Optionally, you can download the sources and recompile them: this simple
process (\verb+./bootstrap; make; make install+) is described at
\url{http://www.cmake.org/HTML/Install.html}.

%==================
\subsubsection{Configuring DIET's compilation: cmake quick introduction}
If you are already experienced with \verb+cmake+ then using it to compile
DIET should provide no surprise. 
DIET respects \verb+cmake+'s best practices e.g.~by clearly separating the
source tree from the binary tree (or compile tree), by exposing the main
configuration optional flag variables prefixed with \verb+DIET_+ (and by
hiding away the technical variables) and by not postponing configuration
difficulties (in particular the handling of external dependencies like
libraries) to compile stage.

\verb+Cmake+ classically provides two ways for setting configuration
parameters in order to generate the makefiles in the form of two
commands \verb+ccmake+ and \verb+cmake+ (the first one has an extra "c"
character): use
\begin{description}
\item{\verb+ccmake [options] <path-to-source>+}\\
  in order to specify the parameters interactively through a GUI interface
\item{\verb+cmake [options] <path-to-source> [-D<var>:<type>=<value>]+}\\
  in order to define the parameters with the \verb+-D+ flag directly
  from the command line.
\end{description}
In the above syntax description of both commands, {\verb+<path-to-source>+}
specifies a path to the top level of the source tree (i.e. where the directory
where the top level CMakeLists.txt file is to be encountered). Also
the current working directory will be used as the root of the build tree for
the project (out of source building is generally encouraged specially
when working on a CVS tree).

Here is a short list of \verb+cmake+ internal parameters that are worth
mentioning:
\begin{itemize}
\item
  \verb+CMAKE_BUILD_TYPE+ controls the type of build mode among which 
  \verb+Debug+ will produce binaries and libraries with the debugging
   information
\item
   \verb+CMAKE_VERBOSE_MAKEFILE+ is a Boolean parameter which when set to
   ON will generate makefiles without the .SILENT directive. This is
   useful for watching the invoked commands and their arguments in case
   things go wrong.
\item
   \verb+CMAKE_C[XX]_FLAGS*+ is a family of parameters used for
   the setting and the customization of various C/C++ compiler options.
\end{itemize}
%
Eventually, here is short list of \verb+ccmake+ interface tips:
\begin{itemize}
\item
  when lost, look at the bottom lines of the interface which always
  summarizes \verb+ccmake+'s most pertinent options (corresponding
  keyboard shortcuts) depending on your current context
\item
  hitting the "h" key will direct you \verb+ccmake+ embedded tutorial
  and a list of keyboard shortcuts (as mentioned in the bottom
  lines, hit "e" to exit)
\item
  up/down navigation among parameter items can be achieved with the
  up/down arrows
\item
  when on a parameter item, the line in inverted colors (close above the
  bottom of the screen) contains a short description of the selected
  parameter as well as the set of possible/recommended values
\item
  toggling of boolean parameters is made with enter
\item
  press \verb+enter+ to edit path variables
\item
  when editing a \verb+PATH+ typed parameter the \verb+TAB+ keyboard
  shortcut provides an emacs-like (or bash-like) automatic path completion.
\item
  toggling of advanced mode (press "t") reveals hidden parameters
\end{itemize}
 
%==================
\subsubsection{DIET's compilation configuration: a ccmake walk-through}

Assume that \verb+CVS_DIET_HOME+ represents a path to the top level
directory of a tree of DIET sources.
This directory tree was either obtained by expanding the DIET current
source level distribution tarball, or for DIET developers corresponds to
the directory GRAAL/devel/diet/diet of a cvs checkout of the DIET sources
hierarchy.
Additionally, assume we created a build tree directory and \verb+cd+
to it (in the example below we chose \verb+CVS_DIET_HOME/Bin+ as
build tree, but feel free to follow your conventions):
\begin{itemize}
\item
  \verb+cd CVS_DIET_HOME/Bin+
\item
  \verb+ccmake ..+ to enter the GUI
  \begin{itemize}
  \item press \verb+c+ (equivalent of bootstrap.sh of the autotools)
  \item toggle the desired options e.g. \verb+DIET_BUILD_EXAMPLES+ or
     \verb+DIET_USE_JXTA+. 
  \item specify the \verb+CMAKE_INSTALL_PREFIX+ parameter (if you wish
     to install in a directory different from \verb+/usr/local+,
  \item press \verb+c+ again, for checking required dependencies
  \item check all the parameters preceded with the * (star) character
     whose value was automatically retrieved by \verb+cmake+.
  \item provide the required information i.e. feel in the proper values
     for all parameters whose value is terminated by NOT-FOUND
  \item iterate the above process of parameter checking, toggle/specification
     and configuration until all configuration information is satisfied
  \item press \verb+g+ to generate the makefile
  \item press \verb+q+ to exit ccmake
  \end{itemize}
\item
  \verb+make+ in order to classically launch the compilation process
\item
  \verb+make install+ when installation is required
\end{itemize}

%==================
\subsubsection{DIET's main optional configuration flags}

Here are the main configuration flags:
\begin{itemize}
\item
  \verb+OMNIORB4_DIR+ is the path to the omniORB4 installation directory
  (only relevant when omniORB4 was not installed in /usr/local).
  Example: \verb+cmake .. -DOMNIORB4_DIR:PATH=$HOME/local/omniORB-4.0.7+

\item
  \verb+DIET_BUILD_DOCUMENTATION+ for building LaTeX-based user's guide,
  the developer's guide and the doxygenated documentation.
  This option is disabled by default, since it is very sensitive to the
  version of your \LaTeX\ compiler and it also relies on many subdependencies
  (e.g. \verb+doxygen+ or \verb+fig2dev+)

\item
  \verb+DIET_BUILD_EXAMPLES+ activates the compilation of a set of
  general client/server examples. Note that some specific examples
  (e.g. \verb+DIET_USE_BLAS+) require some additional flag to be activated
  too.

\item
  \verb+DIET_BUILD_LIBRARIES+ which is enabled by default, activates the
  compilation of the DIET libraries. This option is only useful if you 
  wish to restrict the compilation to the construction of the documentation.

\item
  \verb+DIET_WITH_STATISTICS+ enables the generation of statistics logs
\end{itemize}

\noindent
DIET has many extensions (some of them are still) experimental. These
extensions most often rely on external packages than need to be pre-installed
and some of those extensions offer concurrent functionalities. This explains
the usage of configuration flags in order to obtain the compilation of
the desired extensions.

\begin{itemize}
\item
  \verb+DIET_USE_BLAS+ option activates the compilation of
  the DIET BLAS examples, as a sub-module of examples.
  The BLAS~\footnote{\url{http://www.netlib.org/blas/}} (Basic Linear
  Algebra Subprograms) are high quality ``building block'' routines for
  performing basic vector and matrix operations.
  Level 1 BLAS do vector-vector operations, Level 2 BLAS do matrix-vector
  operations, and Level 3 BLAS do matrix-matrix operations.
  Because the BLAS are efficient, portable, and widely available,
  they're commonly used in the development of high quality linear algebra
  software.
  DIET uses BLAS to build demonstration examples of client/server.
  Note that the  \verb+DIET_USE_BLAS+ can only be effective when 
  \verb+DIET_BUILD_EXAMPLES+ is enabled.
  \verb+DIET_USE_BLAS+ is disabled by default.

\item
  \verb+DIET_USE_CORI+ CoRI, which stands for COllector of Resource
  Information, provides a framework for probing hardware and performance
  information about the SeD.
  CoRI also yields a very basic set of probing resources which are
  heavily dependent on the system calls available for the considered platform.
  When this option is activated (disabled by default), the user can either
  define new collectors or use existing collectors (like FAST, see the
  \verb+DIET_USE_FAST+ option) through CoRI's interface.
  CoRI thus provides a possible tactical approach for tuning the performance
  of your favorite plug-in scheduler.
  Chapter~\ref{chapter:performance} describes in more details CoRI and its
  possible usage within DIET.

\item
  \verb+DIET_USE_FAST+ activates DIET support of FAST (refer to
  \url{http://graal.ens-lyon.fr/FAST/} a grid aware dynamic forecasting
  library. FAST in turn relies on many sub-libraries (GSL, BDB, NWS, LDAP).
  Thus, the activation of this option can only be recommended for advanced
  users...

\item
  \verb+DIET_USE_BATCH+ activates DIET support of Appleseeds (refer to
  \url{http://grail.sdsc.edu/projects/appleseeds/}) based batch
  extensions.

\item
  \verb+DIET_USE_JXTA+ activates the so called MULTI-Master-Agent
  support. This support is based on the JXTA layer (refer to
  \url{http://www.jxta.org/}). This is to be opposed with
  \verb+DIET_WITH_MULTI_MA+ which offers similar functionalities
  but based on CORBA.

\item
  \verb+DIET_WITH_MULTI_MA+ activates the so called MULTI Master Agent
  support. This support is based on the CORBA layer (which is to be
  opposed with \verb+DIET_USE_JXTA+ which offers similar functionalities
  but based on JXTA.

\item
  \verb+DIET_USE_FD+ for activating Fault Detector.

\item
  \verb+DIET_USE_WORKFLOW+ enables the support of workflow.
\end{itemize}

\noindent
Eventually, some configuration flags control the general result of the
compilation or some developers extensions:
\begin{itemize}
\item
  \verb+BUILD_SHARED_LIBS+ is a cmake internal variable which specifies
  whether the libraries should be dynamics as opposed to static

\item
  \verb+DIET_USE_DART+ enables DART reporting system (refer to 
  \url{http://public.kitware.com/Dart}) which is used for constructing
  DIET's dashboard (see \url{http://graal.ens-lyon.fr/DietDashboard}).
\end{itemize}

%====[ Compilation with the autotools ]========================================
\subsection{Compiling DIET with the autotools (under deprecation)}
A configure script will prepare DIET for
compiling: its main options are described below, but please, run
\texttt{configure --help} to get an up-to-date and complete usage
description.\\

\noindent
{\footnotesize
\texttt{$\sim$> tar xzf DIET\_}\dietversion\texttt{.tgz} \\
\texttt{$\sim$> cd DIET} \\
\texttt{$\sim$/DIET> ./configure --help=short} \\
\texttt{Configuration of DIET} \dietversion \texttt{:} \\
\texttt{...}
}

\subsubsection{Optional features for configuration}

{\footnotesize
\begin{verbatim}
  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
  --enable-maintainer-mode enable make rules and dependencies not useful
                          (and sometimes confusing) to the casual installer
\end{verbatim}

\begin{verbatim}
  --enable-doc            enable the module doc, documentation about DIET
\end{verbatim}
}
\noindent This option activates the compilation and installation of
the DIET documents, which is disabled by default, because it is very
sensitive to the version of your \LaTeX\ compiler. The output
postscript files are provided in the archive.

{\footnotesize
\begin{verbatim}
  --disable-examples      disable the module examples, basic DIET examples
\end{verbatim}
}
\noindent This option deactivates the compilation of the DIET
examples, which is enabled by default.

{\footnotesize
\begin{verbatim}
  --enable-BLAS           enable the module BLAS, an example for calling BLAS
                          functions through DIET
\end{verbatim}
}
\noindent This option activates the compilation of the DIET BLAS
examples, as a sub-module of examples (which means that this option
has no effect if examples are disabled) - disabled by default.


{\footnotesize
\begin{verbatim}
 --enable-ScaLAPACK      enable the module ScaLAPACK, an example for calling
                          ScaLAPACK functions through DIET
\end{verbatim}
}
\noindent \textit{Experimental}.  This option activates the
compilation of the DIET \scalapack\ examples, as a sub-module of
examples (which means that this option has no effect if examples are
disabled) - disabled by default.

{\footnotesize
\begin{verbatim}
  --enable-JXTA-mode      enable DIET/JXTA architecture
\end{verbatim}
}
\noindent \textit{Experimental}.  This option allows the user to
deploy DIET$_{JXTA}$ architectures.  When this option is activated
(disabled by default), DIET allows only this type of architecture to
be deployed.

\label{sec:multimainstall}
{\footnotesize
\begin{verbatim}
  --enable-multi-MA       enable multi-MA architecture
\end{verbatim}
}
\noindent \textit{Experimental}.  This option allows the user to
connect several MA to be linked together. When this option is
activated, it allow a MA to looking for a SeD into the other MA
hierarchies.

{\footnotesize
\begin{verbatim}
  --enable-JuxMem       enable the use of JuxMem for managing persistent data
\end{verbatim}
}
\noindent \textit{Experimental}.  This option allows the user to
interact with JuxMem for the management of persistent data. When
this option is activated (disabled by default), a SeD can store data
blocks within JuxMem. Chapter~\ref{ch:juxmem} describes in more
details JuxMem and its use inside DIET.

{\footnotesize
\begin{verbatim}
  --enable-cori       enable the use of CoRI for collecting information 
                      about the SeD
\end{verbatim}
}
\noindent \textit{Experimental}.  This option allows the user to
get hardware and performance information about the SeD. When
this option is activated (disabled by default), the user can call FAST and other 
collectors by the interface CoRI. It can be used to improve the plug-in scheduler.
Chapter~\ref{chapter:performance} describes in more details CoRI and its use inside DIET.

{\footnotesize
\begin{verbatim}
  --enable-stats          enable generation of statistics logs
  --disable-dependency-tracking Speeds up one-time builds
  --enable-dependency-tracking  Do not reject slow dependency extractors
  --enable-shared=PKGS    build shared libraries default=yes
  --enable-static=PKGS    build static libraries default=yes
  --enable-fast-install=PKGS optimize for fast installation default=yes
  --disable-libtool-lock  avoid locking (might break parallel builds)
\end{verbatim}
}

%%{\footnotesize
%%\begin{verbatim}
%%  --enable-logservice     enable monitoring through LogService
%%\end{verbatim}
%%}
%%\noindent \textit{Deprecated}.  Support for the LogService monitoring
%%software is now always compiled in.  Note that support for LogService
%%is built-in and you do not have to install LogService to compile
%%DIET.

\subsubsection{Optional packages for configuration}


{\footnotesize
\begin{verbatim}
  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
  --with-gnu-ld           assume the C compiler uses GNU ld default=no
  --with-pic              try to use only PIC/non-PIC objects default=use both
\end{verbatim}
}

%% \subsubsection{The \texttt{--with-PKG-extra} option}

%% For all packages that DIET depends on, the \texttt{configure} script provides an
%% option that let the user define the arguments needed to compile with the
%% libraries of the package PKG: \texttt{--with-PKG-extra}. This is useful when
%% the \texttt{configure} script does not succeed on its own to get necessary
%% compilation option.

%% Let us take the example of a user who wishes to compile the BLAS examples (see
%% the BLAS subsection below). On the platform he/she uses, it is necessary to
%% specify the following arguments to compile with the BLAS library:

%% {\footnotesize \texttt{-lm -L/home/theuser/lib -lblas -lg2c -lm} }

%% \noindent
%% Let us assume that specifying the option
%% \texttt{--with-BLAS-libraries=/home/theuser/lib} is not enough for the
%% \texttt{configure} script to compile DIET examples. Then, the user will have to
%% add the following arguments to his/her \texttt{configure} command line:

%% {\footnotesize \texttt{--with-BLAS-extra="-lm -L/home/theuser/lib -lblas -lg2c
%%   -lm"} }

\paragraph{omniORB}
{\footnotesize
\begin{verbatim}
  --with-omniORB=DIR      specify the root installation directory of omniORB
  --with-omniORB-includes=DIR
                          specify exact header directory for omniORB
  --with-omniORB-libraries=DIR
                          specify exact library directory for omniORB
  --with-omniORB-extra=ARG|"ARG1 ARG2 ..."
                          specify extra conftest.c -o conftest for the linker
                          to find the omniORB libraries (use "" in case of 
                          several conftest.c -o conftest)
\end{verbatim}
}
\noindent This group of options lets the user define all necessary
paths to compile with omniORB. Generally, \texttt{--with-omniORB=DIR}
should be enough, and the other options are provided for ugly
installations of omniORB.\\ \textbf{NB:} having the executable
\texttt{omniidl} in the PATH environment variable should be enough in
most cases.

\paragraph{FAST}\label{fast_compil}
{\footnotesize
\begin{verbatim}
  --with-FAST=DIR         installation root directory for FAST (optional)
  --with-FAST-bin=DIR     installation directory for fast-config (optional)
\end{verbatim}
}
\noindent This group of options lets the user define all necessary
paths to compile with FAST; Generally, \texttt{--with-FAST=DIR} should
be enough, and the other options are provided for difficult
installations of FAST. There is no need to specify includes, libraries
and extra arguments, since FAST provides a tool \texttt{fast-config}
that does this job automatically.\\ \textbf{NB1:} having the
executable \texttt{fast-config} in the PATH environment variable
should be enough in most cases.\\ \textbf{NB2:} it is possible to
specify \texttt{--without-FAST}, which overrides \texttt{fast-config}
detection.

\paragraph{BLAS}

The BLAS~\footnote{\url{http://www.netlib.org/blas/}} (Basic Linear
Algebra Subprograms) are high quality ``building block'' routines for
performing basic vector and matrix operations.  Level 1 BLAS do
vector-vector operations, Level 2 BLAS do matrix-vector operations,
and Level 3 BLAS do matrix-matrix operations. Because the BLAS are
efficient, portable, and widely available, they're commonly used in
the development of high quality linear algebra software.

{\footnotesize
\begin{verbatim}
  --with-BLAS=DIR  specify the root installation directory of BLAS (Basic
                   Linear Algebric Subroutines)

  --with-BLAS-includes=DIR
                   specify exact header directory for BLAS
  --with-BLAS-libraries=DIR
                   specify exact library directory for BLAS
  --with-BLAS-extra=ARG|"ARG1 ARG2 ..."
                   specify extra conftest.c -o conftest for the linker to find
                   the BLAS libraries (use "" in case of several 
                   conftest.c -o conftest)
\end{verbatim}
}
\noindent This group of options lets the user define all necessary
paths to compile with the BLAS libraries. Generally,
\texttt{--with-BLAS=DIR} should be enough, and the other options are
provided for difficult installation of the BLAS.\\ \textbf{NB:} these
options have no effect if the module example and/or its sub-module
BLAS are disabled.

\paragraph{\scalapack}

The ScaLAPACK\footnote{\url{http://www.netlib.org/scalapack/}} (or
Scalable LAPACK) library includes a subset of LAPACK routines
redesigned for distributed memory MIMD parallel computers. It is
currently written in a Single-Program-Multiple-Data style using
explicit message passing for interprocessor communication. It assumes
matrices are laid out in a two-dimensional block cyclic decomposition.

Like LAPACK, the ScaLAPACK routines are based on block-partitioned
algorithms in order to minimize the frequency of data movements
between different levels of the memory hierarchy. For such machines,
the memory hierarchy includes the off-processor memory of other
processors, in addition to the hierarchy of registers, cache, and
local memory on each processor.  The fundamental building blocks of
the ScaLAPACK library are distributed memory versions (PBLAS) of the
Level 1, 2 and 3 BLAS, and a set of Basic Linear Algebra Communication
Subprograms (BLACS) for communication tasks that arise frequently in
parallel linear algebra computations. In the ScaLAPACK routines, all
interprocessor communication occurs within the PBLAS and the BLACS.
One of the design goals of ScaLAPACK was to have the ScaLAPACK
routines resemble their LAPACK equivalents as much as possible.

For detailed information on ScaLAPACK, please refer to the ScaLAPACK
Users' Guide~\cite{BCC+97}.


{\footnotesize
\begin{verbatim}
  --with-ScaLAPACK=DIR    specify the root installation directory of ScaLAPACK
                          (parallel version of the LAPACK library)

  --with-ScaLAPACK-includes=DIR
                          specify exact header directory for ScaLAPACK
  --with-ScaLAPACK-libraries=DIR
                          specify exact library directory for ScaLAPACK
  --with-ScaLAPACK-extra=ARG|"ARG1 ARG2 ..."
                          specify extra conftest.c -o conftest for the linker to find 
                          the ScaLAPACK libraries (use "" in case of several 
                          conftest.c -o conftest)
\end{verbatim}
}

\noindent This group of options lets the user define all necessary
paths for compilation with the \scalapack\ libraries. Normally,
\texttt{--with-ScaLAPACK=DIR} could be enough, but the other options
are provided because the installation of the \scalapack\ libraries is
often difficult, and thus difficult to detect automatically. For
instance, the \texttt{--with-ScaLAPACK-extra} option is useful to
integrate BLACS and MPI libraries, which are useful for ScaLAPACK.  \\
\textbf{NB:} these options have no effect if the module example and/or
its sub-module \scalapack\ are disabled.

\subsubsection{From configuration to compilation}

An important option for configure scripts is \texttt{--prefix=}, which
specifies where binary files, documents and configuration files will
be installed. It is important to set this option; otherwise it 
defaults to \texttt{DIET/install}.

The configuration will return with an error if no ORB was found. So
please help the configure script to find the ORB with the
\texttt{--with-omniORB*} options.\\


If everything went OK, the configuration ends with a summary of the
options that were selected and what it was possible to get. The output
will look like: {\footnotesize
\begin{verbatim}
~/DIET > ./configure --enable-examples --enable-doc
DIET successfully configured as follows:
 - Batch:           no
 - documents:       yes
 - examples:        dmat_manips, file_transfer, scalars
 - FAST:            disabled
 - CORI:            disabled
 - ORB:             omniORB 4 in /usr
 - prefix:          /home/username/DIET/install
 - multi-MA:        no
 - DIET J:          no
 - Juxmem:          no
 - target platform: i686-pc-linux-gnu
 
Please run make help to get compilation instructions.
~/DIET > make help
====================================================================
 Usage : make help     : shows this help screen
         make agent    : builds DIET agent executable
         make SeD      : builds DIET SeD library
         make client   : builds DIET client library
         make examples : builds basic examples
         make          : builds everything configured
         make install  : copy files into /home/username/DIET/install
====================================================================
\end{verbatim}
}

This helps the user to choose which DIET parts to compile and
install. It is recommended for beginners to compile the client,
the SeD and the agent in one single step with \texttt{make all}. But
please pay attention to the fact that \texttt{make all} does not
install DIET in the prefix provided at configuration time. To do this,
run \texttt{make install}.

\texttt{make install} will run the compilation for all DIET entities
before the installation itself. Thus, if the user wants to compile
only the agent, for instance, and install it, he must run:
{\footnotesize
\begin{verbatim}
~/DIET > cd src/agent
~DIET/src/agent > make install
\end{verbatim}
}


\section{Compiling the examples}

Four series of examples are provided in the DIET archive:
\begin{itemize}
\item{\texttt{file\_transfer}}: the server computes the sizes of two
  input files and returns them. A third output parameter may be
  returned; the server decides randomly whether to send back the
  first file. This is to show how to manage a variable number of
  arguments: the profile declares all arguments that may be filled,
  even if they might not be all filled at each request/computation.

\item{\texttt{dmat\_manips}}: the server offers matrix manipulation
  routines: transposition (\texttt{T}), product (\texttt{MatPROD}) and
  sum (\texttt{MatSUM}, \texttt{SqMatSUM} for square matrices, and
  \texttt{SqMatSUM\_opt} for square matrices but re-using the memory
  space of the second operand for the result). Any subset of these
  operations can be specified on the command line. The last two of
  them are given for compatibility with a BLAS server as explained below.
  
\item{\texttt{BLAS}}: the server offers the \texttt{dgemm} BLAS
  functionality.  We plan to offer all BLAS (Basic Linear Algebric
  Subroutines) in the future. Since this function computes
  $C = \alpha AB + \beta C$, it can also compute a matrix-matrix
  product, a sum of square matrices, etc. All these services are
  offered by the BLAS server. Two clients are designed to use these
  services: one (\texttt{dgemm\_client.c}) is designed to use the
  \texttt{dgemm\_} function only, and the other one
  (\texttt{client.c}) to use all BLAS functions (but currently only
  \texttt{dgemm\_}) and sub-services, such as \texttt{MatPROD}.
  
\item{\texttt{\scalapack}}: the server is designed to offer all
  \scalapack\  (parallel version of the LAPACK library) functions but
  only manages the \texttt{pdgemm\_} function so far. The
  \texttt{pdgemm\_} routine is the parallel version of the
  \texttt{dgemm\_} function, so that the server also offers all the
  same sub-services. Two clients are designed to use these services:
  one (\texttt{pdgemm\_client.c}) is designed to use the
  \texttt{pdgemm\_} function only, and the other one
  (\texttt{client.c}) to use all \scalapack\ functions and
  sub-services, such as \texttt{MatPROD}.
\end{itemize}

\subsection{Compiling the examples with cmake}
\verb+Cmake+ will compile the examples when setting the 
\verb+DIET_BUILD_EXAMPLES+ to \verb+ON+ which can be achieved by
toggling the corresponding entry of \verb+ccmake+ GUI's or by adding
\verb+-DDIET_BUILD_EXAMPLES:BOOL=ON+ to the command line
arguments of \verb+[c]cmake+ invocation.

\subsection{Compiling the examples with the autotools}

Running \texttt{make install} in the \texttt{examples} directory (or
in the root directory, when DIET is configured with
\texttt{--enable-examples}) does not copy binary files into
\texttt{$<$install\_dir$>$/bin}, but in \texttt{examples/bin}: this
odd behaviour is due to some limitations of the \textsf{automake} tool.

Likewise, the samples of configuration files located in
\texttt{examples/cfgs} are processed by \texttt{make install} to
create ready-to-use configuration files in \texttt{examples/etc} and
then copied into \texttt{$<$install\_dir$>$/etc}. Successive calls to
make install will not erase the configuration files created and copied
the first time, except if \texttt{make uninstall} is called inbetween
; thus the user will not lose changes to these files.

